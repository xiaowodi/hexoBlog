<svg id="SvgjsSvg1844" width="1576.4166870117188" height="2812.0695190429688" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.com/svgjs"><defs id="SvgjsDefs1845"><marker id="SvgjsMarker1968" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1969" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1972" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1973" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1976" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1977" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker2008" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath2009" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker2074" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath2075" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker2108" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath2109" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker2352" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath2353" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker2356" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath2357" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker2372" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath2373" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker2410" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath2411" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker2414" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath2415" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker2464" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath2465" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker2468" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath2469" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker2572" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath2573" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker2600" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath2601" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker2674" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath2675" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker2678" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath2679" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker></defs><g id="SvgjsG1846" transform="translate(605.0833182864718,25.009226481118972)"><path id="SvgjsPath1847" d="M 0 0L 297 0L 297 35L 0 35Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1848"><text id="SvgjsText1849" font-family="微软雅黑" text-anchor="middle" font-size="15px" width="277px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="15px" weight="400" font-style="" opacity="1" y="6.125" transform="rotate(0)"><tspan id="SvgjsTspan1850" dy="18" x="148.5"><tspan id="SvgjsTspan1851" style="text-decoration:;">rdd.map(x=&gt;(x.key, x.value)).collect()</tspan></tspan></text></g></g><g id="SvgjsG1852" transform="translate(204.7499843173557,175.56480534871397)"><path id="SvgjsPath1853" d="M 0 0L 1097.6666679382322 0L 1097.6666679382322 1071.8518511454265L 0 1071.8518511454265Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1854"><text id="SvgjsText1855" font-family="微软雅黑" text-anchor="middle" font-size="15px" width="1078px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="15px" weight="400" font-style="" opacity="1" y="196.55092557271325" transform="rotate(0)"><tspan id="SvgjsTspan1856" dy="18" x="549"><tspan id="SvgjsTspan1857" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1858" dy="18" x="549"><tspan id="SvgjsTspan1859" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1860" dy="18" x="549"><tspan id="SvgjsTspan1861" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1862" dy="18" x="549"><tspan id="SvgjsTspan1863" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1864" dy="18" x="549"><tspan id="SvgjsTspan1865" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1866" dy="18" x="549"><tspan id="SvgjsTspan1867" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1868" dy="18" x="549"><tspan id="SvgjsTspan1869" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1870" dy="18" x="549"><tspan id="SvgjsTspan1871" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1872" dy="18" x="549"><tspan id="SvgjsTspan1873" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1874" dy="18" x="549"><tspan id="SvgjsTspan1875" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1876" dy="18" x="549"><tspan id="SvgjsTspan1877" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1878" dy="18" x="549"><tspan id="SvgjsTspan1879" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1880" dy="18" x="549"><tspan id="SvgjsTspan1881" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1882" dy="18" x="549"><tspan id="SvgjsTspan1883" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1884" dy="18" x="549"><tspan id="SvgjsTspan1885" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1886" dy="18" x="549"><tspan id="SvgjsTspan1887" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1888" dy="18" x="549"><tspan id="SvgjsTspan1889" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1890" dy="18" x="549"><tspan id="SvgjsTspan1891" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1892" dy="18" x="549"><tspan id="SvgjsTspan1893" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1894" dy="18" x="549"><tspan id="SvgjsTspan1895" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1896" dy="18" x="549"><tspan id="SvgjsTspan1897" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1898" dy="18" x="549"><tspan id="SvgjsTspan1899" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1900" dy="18" x="549"><tspan id="SvgjsTspan1901" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1902" dy="18" x="549"><tspan id="SvgjsTspan1903" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1904" dy="18" x="549"><tspan id="SvgjsTspan1905" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1906" dy="18" x="549"><tspan id="SvgjsTspan1907" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1908" dy="18" x="549"><tspan id="SvgjsTspan1909" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1910" dy="18" x="549"><tspan id="SvgjsTspan1911" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1912" dy="18" x="549"><tspan id="SvgjsTspan1913" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1914" dy="18" x="549"><tspan id="SvgjsTspan1915" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1916" dy="18" x="549"><tspan id="SvgjsTspan1917" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1918" dy="18" x="549"><tspan id="SvgjsTspan1919" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1920" dy="18" x="549"><tspan id="SvgjsTspan1921" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1922" dy="18" x="549"><tspan id="SvgjsTspan1923" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1924" dy="18" x="549"><tspan id="SvgjsTspan1925" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1926" dy="18" x="549"><tspan id="SvgjsTspan1927" style="text-decoration:;"> </tspan></tspan></text></g></g><g id="SvgjsG1928" transform="translate(231.74998431735582,268.69443511962953)"><path id="SvgjsPath1929" d="M 0 0L 87.77777862548822 0L 87.77777862548822 41.87037022908521L 0 41.87037022908521Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1930"><text id="SvgjsText1931" font-family="微软雅黑" text-anchor="middle" font-size="15px" width="68px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="15px" weight="400" font-style="" opacity="1" y="9.560185114542605" transform="rotate(0)"><tspan id="SvgjsTspan1932" dy="18" x="44"><tspan id="SvgjsTspan1933" style="text-decoration:;">runJob()</tspan></tspan></text></g></g><g id="SvgjsG1934" transform="translate(384.88887299431644,268.69443511962965)"><path id="SvgjsPath1935" d="M 0 0L 109.83333460489916 0L 109.83333460489916 41.87037022908498L 0 41.87037022908498Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#fff176"></path><g id="SvgjsG1936"><text id="SvgjsText1937" font-family="微软雅黑" text-anchor="middle" font-size="15px" width="90px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="15px" weight="400" font-style="" opacity="1" y="9.560185114542492" transform="rotate(0)"><tspan id="SvgjsTspan1938" dy="18" x="55"><tspan id="SvgjsTspan1939" style="text-decoration:;">submitJob()</tspan></tspan></text></g></g><g id="SvgjsG1940" transform="translate(571.749984317355,239.52776845296302)"><path id="SvgjsPath1941" d="M 0 0L 244.83333460489894 0L 244.83333460489894 100.2037035624179L 0 100.2037035624179Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#4dd0e1"></path><g id="SvgjsG1942"><text id="SvgjsText1943" font-family="微软雅黑" text-anchor="middle" font-size="15px" width="225px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="15px" weight="700" font-style="" opacity="1" y="20.22685178120895" transform="rotate(0)"><tspan id="SvgjsTspan1944" dy="18" x="122.5"><tspan id="SvgjsTspan1945" style="text-decoration:;">DAGSchedulerEvent</tspan></tspan><tspan id="SvgjsTspan1946" dy="18" x="122.5"><tspan id="SvgjsTspan1947" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1948" dy="18" x="122.5"><tspan id="SvgjsTspan1949" style="text-decoration:;">创建JobSumitted(rdd)事件</tspan></tspan></text></g></g><g id="SvgjsG1950" transform="translate(883.4166509840225,184.0879529317229)"><path id="SvgjsPath1951" d="M 0 0L 294.0000012715657 0L 294.0000012715657 211.0833346048982L 0 211.0833346048982Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#bbdefb"></path><g id="SvgjsG1952"><text id="SvgjsText1953" font-family="微软雅黑" text-anchor="middle" font-size="15px" width="275px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="15px" weight="700" font-style="" opacity="1" y="47.1666673024491" transform="rotate(0)"><tspan id="SvgjsTspan1954" dy="18" x="147.5"><tspan id="SvgjsTspan1955" style="text-decoration:;">DAGSchedulerEventProcessLoop</tspan></tspan><tspan id="SvgjsTspan1956" dy="18" x="147.5"><tspan id="SvgjsTspan1957" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1958" dy="18" x="147.5"><tspan id="SvgjsTspan1959" style="text-decoration:;">1. 添加到EventQueue事件队列中</tspan></tspan><tspan id="SvgjsTspan1960" dy="18" x="147.5"><tspan id="SvgjsTspan1961" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1962" dy="18" x="147.5"><tspan id="SvgjsTspan1963" style="text-decoration:;">2. eventThread子线程的run()方法取出</tspan></tspan><tspan id="SvgjsTspan1964" dy="18" x="147.5"><tspan id="SvgjsTspan1965" style="text-decoration:;">阻塞队列的event事件</tspan></tspan></text></g></g><g id="SvgjsG1966"><path id="SvgjsPath1967" d="M319.52776294284376 289.62962023417214L352.2083179685801 289.62962023417214L352.2083179685801 289.62962023417214L384.88887299431644 289.62962023417214" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1968)"></path></g><g id="SvgjsG1970"><path id="SvgjsPath1971" d="M494.7222075992156 289.62962023417214L533.2360959582852 289.62962023417214L533.2360959582852 289.62962023417214L571.749984317355 289.62962023417214" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1972)"></path></g><g id="SvgjsG1974"><path id="SvgjsPath1975" d="M816.5833189222546 289.62962023417197L849.9999849531384 289.62962023417197L849.9999849531384 289.629620234172L883.4166509840225 289.629620234172" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1976)"></path></g><g id="SvgjsG1978" transform="translate(312.58331765068897,459.1111017862962)"><path id="SvgjsPath1979" d="M 0 0L 904.0000012715656 0L 904.0000012715656 254.97222137451092L 0 254.97222137451092Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ff9800"></path><g id="SvgjsG1980"><text id="SvgjsText1981" font-family="微软雅黑" text-anchor="middle" font-size="15px" width="885px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="15px" weight="700" font-style="" opacity="1" y="13.111110687255461" transform="rotate(0)"><tspan id="SvgjsTspan1982" dy="18" x="452.5"><tspan id="SvgjsTspan1983" style="text-decoration:;">handleJobSubmitted()处理取出来的事件</tspan></tspan><tspan id="SvgjsTspan1984" dy="18" x="452.5"><tspan id="SvgjsTspan1985" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1986" dy="18" x="452.5"><tspan id="SvgjsTspan1987" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1988" dy="18" x="452.5"><tspan id="SvgjsTspan1989" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1990" dy="18" x="452.5"><tspan id="SvgjsTspan1991" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1992" dy="18" x="452.5"><tspan id="SvgjsTspan1993" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1994" dy="18" x="452.5"><tspan id="SvgjsTspan1995" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1996" dy="18" x="452.5"><tspan id="SvgjsTspan1997" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1998" dy="18" x="452.5"><tspan id="SvgjsTspan1999" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2000" dy="18" x="452.5"><tspan id="SvgjsTspan2001" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2002" dy="18" x="452.5"><tspan id="SvgjsTspan2003" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2004" dy="18" x="452.5"><tspan id="SvgjsTspan2005" style="text-decoration:;"> </tspan></tspan></text></g></g><g id="SvgjsG2006"><path id="SvgjsPath2007" d="M1030.4166516198054 395.17128753662104L1030.4166516198054 427.1411946614586L764.583318286471 427.1411946614586L764.583318286471 459.1111017862962" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker2008)"></path></g><g id="SvgjsG2010" transform="translate(363.91665352715177,501.3981450398762)"><path id="SvgjsPath2011" d="M 0 0L 280.9999987284357 0L 280.9999987284357 57.59258270263672L 0 57.59258270263672Z" stroke="none" fill="none"></path><g id="SvgjsG2012"><text id="SvgjsText2013" font-family="微软雅黑" text-anchor="start" font-size="15px" width="281px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="15px" weight="700" font-style="" opacity="1" y="17.42129135131836" transform="rotate(0)"><tspan id="SvgjsTspan2014" dy="18" x="0"><tspan id="SvgjsTspan2015" style="text-decoration:;">1. 定义ResultStage：finalStage</tspan></tspan></text></g></g><g id="SvgjsG2016" transform="translate(367.33331955803646,554.7314783732089)"><path id="SvgjsPath2017" d="M 0 0L 836.9999974568707 0L 836.9999974568707 90.1851781209316L 0 90.1851781209316Z" stroke="none" fill="none"></path><g id="SvgjsG2018"><text id="SvgjsText2019" font-family="微软雅黑" text-anchor="start" font-size="15px" width="837px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="15px" weight="700" font-style="" opacity="1" y="5.717589060465798" transform="rotate(0)"><tspan id="SvgjsTspan2020" dy="18" x="0"><tspan id="SvgjsTspan2021" style="text-decoration:;">2. 创建ResultStage赋值给finalStage</tspan></tspan><tspan id="SvgjsTspan2022" dy="18" x="0"><tspan id="SvgjsTspan2023" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2024" dy="18" x="0"><tspan id="SvgjsTspan2025" style="text-decoration:;">在创建ResultStage的过程会判断当前阶段是否存在父节点，如果存在父阶段就创建相应的ShuffleMapStage阶段；</tspan></tspan><tspan id="SvgjsTspan2026" dy="18" x="0"><tspan id="SvgjsTspan2027" style="text-decoration:;">最终父阶段会存放到parents变量中，并封装成stage对象进行返回，所以每一个阶段都会记录相应的父阶段parent的信息；</tspan></tspan></text></g></g><g id="SvgjsG2028" transform="translate(363.91665352715177,644.7314783732089)"><path id="SvgjsPath2029" d="M 0 0L 813.4999987284364 0L 813.4999987284364 52.68517812093171L 0 52.68517812093171Z" stroke="none" fill="none"></path><g id="SvgjsG2030"><text id="SvgjsText2031" font-family="微软雅黑" text-anchor="start" font-size="15px" width="814px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="15px" weight="700" font-style="" opacity="1" y="5.967589060465855" transform="rotate(0)"><tspan id="SvgjsTspan2032" dy="18" x="0"><tspan id="SvgjsTspan2033" style="text-decoration:;">3. ResultStage创建完成之后，整个的阶段划分就完成了；接下来会通过submitStage()方法提交ResultStage阶段</tspan></tspan><tspan id="SvgjsTspan2034" dy="18" x="0"><tspan id="SvgjsTspan2035" style="text-decoration:;"> </tspan></tspan></text></g></g><g id="SvgjsG2036" transform="translate(684.9166522555865,178.89814503987623)"><path id="SvgjsPath2037" d="M 0 0L 131.66666666666748 0L 131.66666666666748 33.14814249674484L 0 33.14814249674484Z" stroke="none" fill="none"></path><g id="SvgjsG2038"><text id="SvgjsText2039" font-family="微软雅黑" text-anchor="start" font-size="15px" width="132px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="15px" weight="700" font-style="" opacity="1" y="5.1990712483724195" transform="rotate(0)"><tspan id="SvgjsTspan2040" dy="18" x="0"><tspan id="SvgjsTspan2041" style="text-decoration:;">DAGScheduler</tspan></tspan></text></g></g><g id="SvgjsG2042" transform="translate(312.58331765068874,804.4768473307282)"><path id="SvgjsPath2043" d="M 0 0L 904.0000012715659 0L 904.0000012715659 145.9027862548836L 0 145.9027862548836Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#fff176"></path><g id="SvgjsG2044"><text id="SvgjsText2045" font-family="微软雅黑" text-anchor="middle" font-size="15px" width="885px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="15px" weight="700" font-style="" opacity="1" y="5.076393127441804" transform="rotate(0)"><tspan id="SvgjsTspan2046" dy="18" x="452.5"><tspan id="SvgjsTspan2047" style="text-decoration:;">submitStage(stage)进行阶段的提交</tspan></tspan><tspan id="SvgjsTspan2048" dy="18" x="452.5"><tspan id="SvgjsTspan2049" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2050" dy="18" x="452.5"><tspan id="SvgjsTspan2051" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2052" dy="18" x="452.5"><tspan id="SvgjsTspan2053" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2054" dy="18" x="452.5"><tspan id="SvgjsTspan2055" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2056" dy="18" x="452.5"><tspan id="SvgjsTspan2057" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2058" dy="18" x="452.5"><tspan id="SvgjsTspan2059" style="text-decoration:;"> </tspan></tspan></text></g></g><g id="SvgjsG2060" transform="translate(377.52776357862604,855.5648117065431)"><path id="SvgjsPath2061" d="M 0 0L 816.6111094156914 0L 816.6111094156914 64.25927480061819L 0 64.25927480061819Z" stroke="none" fill="none"></path><g id="SvgjsG2062"><text id="SvgjsText2063" font-family="微软雅黑" text-anchor="start" font-size="15px" width="817px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="15px" weight="700" font-style="" opacity="1" y="-7.245362599690907" transform="rotate(0)"><tspan id="SvgjsTspan2064" dy="18" x="0"><tspan id="SvgjsTspan2065" style="text-decoration:;">1. 提交传过来的stage之前，首先会尝试获取当前阶段的父阶段（missing=getMissingParentStages(stage)）</tspan></tspan><tspan id="SvgjsTspan2066" dy="18" x="0"><tspan id="SvgjsTspan2067" style="text-decoration:;">    如果父阶段不为空，就递归的提交父阶段submitStage(parent&lt;-missing)</tspan></tspan><tspan id="SvgjsTspan2068" dy="18" x="0"><tspan id="SvgjsTspan2069" style="text-decoration:;">2. 如果父阶段为空，就通过subMissingTasks(stage, jobId.get) 进行本阶段任务的提交</tspan></tspan><tspan id="SvgjsTspan2070" dy="18" x="0"><tspan id="SvgjsTspan2071" style="text-decoration:;"> </tspan></tspan></text></g></g><g id="SvgjsG2072"><path id="SvgjsPath2073" d="M764.5833182864715 714.0833231608071L764.5833182864715 759.2800852457676L764.5833182864715 759.2800852457676L764.5833182864715 804.4768473307282" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker2074)"></path></g><g id="SvgjsG2076" transform="translate(307.83331892225385,1025.3101806640616)"><path id="SvgjsPath2077" d="M 0 0L 904.5833333333339 0L 904.5833333333339 174.5139058430998L 0 174.5139058430998Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#f44336"></path><g id="SvgjsG2078"><text id="SvgjsText2079" font-family="微软雅黑" text-anchor="start" font-size="15px" width="885px" fill="#323232" font-weight="700" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="15px" weight="700" font-style="" opacity="1" y="-1.875" transform="rotate(0)"><tspan id="SvgjsTspan2080" dy="18" x="10"><tspan id="SvgjsTspan2081" style="text-decoration:;"> </tspan></tspan></text></g></g><g id="SvgjsG2082" transform="translate(489.6110969119593,1024.0833295186342)"><path id="SvgjsPath2083" d="M 0 0L 549.9444427490247 0L 549.9444427490247 53.217595418295105L 0 53.217595418295105Z" stroke="none" fill="none"></path><g id="SvgjsG2084"><text id="SvgjsText2085" font-family="微软雅黑" text-anchor="start" font-size="15px" width="550px" fill="#ffffff" font-weight="700" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="15px" weight="700" font-style="" opacity="1" y="15.233797709147552" transform="rotate(0)"><tspan id="SvgjsTspan2086" dy="18" x="0"><tspan id="SvgjsTspan2087" style="text-decoration:;">submitMissingTasks(stage)方法根据传过来的stage创建相应阶段的任务Task</tspan></tspan></text></g></g><g id="SvgjsG2088" transform="translate(367.33331955803646,1077.9722417195637)"><path id="SvgjsPath2089" d="M 0 0L 785.5833320617683 0L 785.5833320617683 47.68517812093114L 0 47.68517812093114Z" stroke="none" fill="none"></path><g id="SvgjsG2090"><text id="SvgjsText2091" font-family="微软雅黑" text-anchor="start" font-size="15px" width="786px" fill="#ffffff" font-weight="700" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="15px" weight="700" font-style="" opacity="1" y="-6.032410939534429" transform="rotate(0)"><tspan id="SvgjsTspan2092" dy="18" x="0"><tspan id="SvgjsTspan2093" style="text-decoration:;">根据传递过来的Stage的类型：</tspan></tspan><tspan id="SvgjsTspan2094" dy="18" x="0"><tspan id="SvgjsTspan2095" style="text-decoration:;">                                    ShuffleMapStage还是ResultStage类型</tspan></tspan><tspan id="SvgjsTspan2096" dy="18" x="0"><tspan id="SvgjsTspan2097" style="text-decoration:;">创建相应类型的Task：  ShuffleMapTask还是ResultTask</tspan></tspan></text></g></g><g id="SvgjsG2098" transform="translate(371.79165225558745,1139.6389083862305)"><path id="SvgjsPath2099" d="M 0 0L 785.5833320617683 0L 785.5833320617683 47.68517812093114L 0 47.68517812093114Z" stroke="none" fill="none"></path><g id="SvgjsG2100"><text id="SvgjsText2101" font-family="微软雅黑" text-anchor="start" font-size="15px" width="786px" fill="#ffffff" font-weight="700" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="15px" weight="700" font-style="" opacity="1" y="3.4675890604655706" transform="rotate(0)"><tspan id="SvgjsTspan2102" dy="18" x="0"><tspan id="SvgjsTspan2103" style="text-decoration:;">Task创建完毕之后，将Task封装成TaskSet对象，以TaskSet为单位，通过TaskScheduler.submitTask()方法发送给</tspan></tspan><tspan id="SvgjsTspan2104" dy="18" x="0"><tspan id="SvgjsTspan2105" style="text-decoration:;">TaskScheduler进行任务的调度</tspan></tspan></text></g></g><g id="SvgjsG2106"><path id="SvgjsPath2107" d="M764.5833182864715 950.3796335856118L764.5833182864715 987.231481552123L764.5833182864715 987.231481552123L764.5833182864715 1024.0833295186342" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker2108)"></path></g><g id="SvgjsG2110" transform="translate(25.009246402314545,1319.535774286773)"><path id="SvgjsPath2111" d="M 0 0L 652.462965435454 0L 652.462965435454 811.5475425162053L 0 811.5475425162053Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG2112"><text id="SvgjsText2113" font-family="微软雅黑" text-anchor="middle" font-size="15px" width="633px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="15px" weight="400" font-style="" opacity="1" y="66.39877125810267" transform="rotate(0)"><tspan id="SvgjsTspan2114" dy="18" x="326.5"><tspan id="SvgjsTspan2115" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2116" dy="18" x="326.5"><tspan id="SvgjsTspan2117" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2118" dy="18" x="326.5"><tspan id="SvgjsTspan2119" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2120" dy="18" x="326.5"><tspan id="SvgjsTspan2121" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2122" dy="18" x="326.5"><tspan id="SvgjsTspan2123" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2124" dy="18" x="326.5"><tspan id="SvgjsTspan2125" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2126" dy="18" x="326.5"><tspan id="SvgjsTspan2127" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2128" dy="18" x="326.5"><tspan id="SvgjsTspan2129" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2130" dy="18" x="326.5"><tspan id="SvgjsTspan2131" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2132" dy="18" x="326.5"><tspan id="SvgjsTspan2133" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2134" dy="18" x="326.5"><tspan id="SvgjsTspan2135" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2136" dy="18" x="326.5"><tspan id="SvgjsTspan2137" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2138" dy="18" x="326.5"><tspan id="SvgjsTspan2139" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2140" dy="18" x="326.5"><tspan id="SvgjsTspan2141" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2142" dy="18" x="326.5"><tspan id="SvgjsTspan2143" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2144" dy="18" x="326.5"><tspan id="SvgjsTspan2145" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2146" dy="18" x="326.5"><tspan id="SvgjsTspan2147" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2148" dy="18" x="326.5"><tspan id="SvgjsTspan2149" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2150" dy="18" x="326.5"><tspan id="SvgjsTspan2151" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2152" dy="18" x="326.5"><tspan id="SvgjsTspan2153" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2154" dy="18" x="326.5"><tspan id="SvgjsTspan2155" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2156" dy="18" x="326.5"><tspan id="SvgjsTspan2157" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2158" dy="18" x="326.5"><tspan id="SvgjsTspan2159" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2160" dy="18" x="326.5"><tspan id="SvgjsTspan2161" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2162" dy="18" x="326.5"><tspan id="SvgjsTspan2163" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2164" dy="18" x="326.5"><tspan id="SvgjsTspan2165" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2166" dy="18" x="326.5"><tspan id="SvgjsTspan2167" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2168" dy="18" x="326.5"><tspan id="SvgjsTspan2169" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2170" dy="18" x="326.5"><tspan id="SvgjsTspan2171" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2172" dy="18" x="326.5"><tspan id="SvgjsTspan2173" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2174" dy="18" x="326.5"><tspan id="SvgjsTspan2175" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2176" dy="18" x="326.5"><tspan id="SvgjsTspan2177" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2178" dy="18" x="326.5"><tspan id="SvgjsTspan2179" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2180" dy="18" x="326.5"><tspan id="SvgjsTspan2181" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2182" dy="18" x="326.5"><tspan id="SvgjsTspan2183" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2184" dy="18" x="326.5"><tspan id="SvgjsTspan2185" style="text-decoration:;"> </tspan></tspan></text></g></g><g id="SvgjsG2186" transform="translate(285.4021771565452,1326.0445596343907)"><path id="SvgjsPath2187" d="M 0 0L 142.261697240991 0L 142.261697240991 64.72611979978427L 0 64.72611979978427Z" stroke="none" fill="none"></path><g id="SvgjsG2188"><text id="SvgjsText2189" font-family="微软雅黑" text-anchor="start" font-size="15px" width="143px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="15px" weight="700" font-style="" opacity="1" y="20.988059899892136" transform="rotate(0)"><tspan id="SvgjsTspan2190" dy="18" x="0"><tspan id="SvgjsTspan2191" style="text-decoration:;">TaskScheduler</tspan></tspan></text></g></g><g id="SvgjsG2192" transform="translate(869.9166522555887,1319.535774286773)"><path id="SvgjsPath2193" d="M 0 0L 670.7777752346457 0L 670.7777752346457 811.5475425162053L 0 811.5475425162053Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG2194"><text id="SvgjsText2195" font-family="微软雅黑" text-anchor="middle" font-size="15px" width="651px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="15px" weight="400" font-style="" opacity="1" y="66.39877125810267" transform="rotate(0)"><tspan id="SvgjsTspan2196" dy="18" x="335.5"><tspan id="SvgjsTspan2197" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2198" dy="18" x="335.5"><tspan id="SvgjsTspan2199" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2200" dy="18" x="335.5"><tspan id="SvgjsTspan2201" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2202" dy="18" x="335.5"><tspan id="SvgjsTspan2203" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2204" dy="18" x="335.5"><tspan id="SvgjsTspan2205" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2206" dy="18" x="335.5"><tspan id="SvgjsTspan2207" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2208" dy="18" x="335.5"><tspan id="SvgjsTspan2209" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2210" dy="18" x="335.5"><tspan id="SvgjsTspan2211" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2212" dy="18" x="335.5"><tspan id="SvgjsTspan2213" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2214" dy="18" x="335.5"><tspan id="SvgjsTspan2215" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2216" dy="18" x="335.5"><tspan id="SvgjsTspan2217" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2218" dy="18" x="335.5"><tspan id="SvgjsTspan2219" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2220" dy="18" x="335.5"><tspan id="SvgjsTspan2221" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2222" dy="18" x="335.5"><tspan id="SvgjsTspan2223" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2224" dy="18" x="335.5"><tspan id="SvgjsTspan2225" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2226" dy="18" x="335.5"><tspan id="SvgjsTspan2227" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2228" dy="18" x="335.5"><tspan id="SvgjsTspan2229" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2230" dy="18" x="335.5"><tspan id="SvgjsTspan2231" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2232" dy="18" x="335.5"><tspan id="SvgjsTspan2233" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2234" dy="18" x="335.5"><tspan id="SvgjsTspan2235" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2236" dy="18" x="335.5"><tspan id="SvgjsTspan2237" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2238" dy="18" x="335.5"><tspan id="SvgjsTspan2239" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2240" dy="18" x="335.5"><tspan id="SvgjsTspan2241" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2242" dy="18" x="335.5"><tspan id="SvgjsTspan2243" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2244" dy="18" x="335.5"><tspan id="SvgjsTspan2245" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2246" dy="18" x="335.5"><tspan id="SvgjsTspan2247" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2248" dy="18" x="335.5"><tspan id="SvgjsTspan2249" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2250" dy="18" x="335.5"><tspan id="SvgjsTspan2251" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2252" dy="18" x="335.5"><tspan id="SvgjsTspan2253" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2254" dy="18" x="335.5"><tspan id="SvgjsTspan2255" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2256" dy="18" x="335.5"><tspan id="SvgjsTspan2257" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2258" dy="18" x="335.5"><tspan id="SvgjsTspan2259" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2260" dy="18" x="335.5"><tspan id="SvgjsTspan2261" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2262" dy="18" x="335.5"><tspan id="SvgjsTspan2263" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2264" dy="18" x="335.5"><tspan id="SvgjsTspan2265" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2266" dy="18" x="335.5"><tspan id="SvgjsTspan2267" style="text-decoration:;"> </tspan></tspan></text></g></g><g id="SvgjsG2268" transform="translate(1025.249984741211,1320.1549111528923)"><path id="SvgjsPath2269" d="M 0 0L 442.3333282470703 0L 442.3333282470703 39.03957737249834L 0 39.03957737249834Z" stroke="none" fill="none"></path><g id="SvgjsG2270"><text id="SvgjsText2271" font-family="微软雅黑" text-anchor="start" font-size="15px" width="443px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="15px" weight="700" font-style="" opacity="1" y="8.144788686249171" transform="rotate(0)"><tspan id="SvgjsTspan2272" dy="18" x="0"><tspan id="SvgjsTspan2273" style="text-decoration:;">SchedulerBackend: CoarseGrainedSchedulerBackend</tspan></tspan></text></g></g><g id="SvgjsG2274" transform="translate(96.77040610977639,1407.138908386231)"><path id="SvgjsPath2275" d="M 0 0L 517.9444446563713 0L 517.9444446563713 260.5000381469722L 0 260.5000381469722Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#fff176"></path><g id="SvgjsG2276"><text id="SvgjsText2277" font-family="微软雅黑" text-anchor="middle" font-size="16px" width="498px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="16px" weight="700" font-style="" opacity="1" y="8.2500190734861" transform="rotate(0)"><tspan id="SvgjsTspan2278" dy="20" x="259"><tspan id="SvgjsTspan2279" style="text-decoration:;">submitTasks(TaskSet)</tspan></tspan><tspan id="SvgjsTspan2280" dy="20" x="259"><tspan id="SvgjsTspan2281" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2282" dy="20" x="259"><tspan id="SvgjsTspan2283" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2284" dy="20" x="259"><tspan id="SvgjsTspan2285" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2286" dy="20" x="259"><tspan id="SvgjsTspan2287" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2288" dy="20" x="259"><tspan id="SvgjsTspan2289" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2290" dy="20" x="259"><tspan id="SvgjsTspan2291" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2292" dy="20" x="259"><tspan id="SvgjsTspan2293" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2294" dy="20" x="259"><tspan id="SvgjsTspan2295" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2296" dy="20" x="259"><tspan id="SvgjsTspan2297" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2298" dy="20" x="259"><tspan id="SvgjsTspan2299" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2300" dy="20" x="259"><tspan id="SvgjsTspan2301" style="text-decoration:;"> </tspan></tspan></text></g></g><g id="SvgjsG2302" transform="translate(159.88506413392747,1444.2916755676254)"><path id="SvgjsPath2303" d="M 0 0L 391.7151286080691 0L 391.7151286080691 69.51610449253099L 0 69.51610449253099Z" stroke="none" fill="none"></path><g id="SvgjsG2304"><text id="SvgjsText2305" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="392px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="700" font-style="" opacity="1" y="7.008052246265493" transform="rotate(0)"><tspan id="SvgjsTspan2306" dy="17" x="196"><tspan id="SvgjsTspan2307" style="text-decoration:;">将TaskSet进一步封装成TaskSetManager对象；</tspan></tspan><tspan id="SvgjsTspan2308" dy="17" x="196"><tspan id="SvgjsTspan2309" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2310" dy="17" x="196"><tspan id="SvgjsTspan2311" style="text-decoration:;">并按照FIFO或者Fair策略添加 到资源调度池rootPool中</tspan></tspan></text></g></g><g id="SvgjsG2312" transform="translate(129.90029684835338,1529.491152561404)"><path id="SvgjsPath2313" d="M 0 4Q 0 0 4 0L 447.6846631792173 0Q 451.6846631792173 0 451.6846631792173 4L 451.6846631792173 125.3965972263095Q 451.6846631792173 129.3965972263095 447.6846631792173 129.3965972263095L 4 129.3965972263095Q 0 129.3965972263095 0 125.3965972263095Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ff9800"></path><g id="SvgjsG2314"><text id="SvgjsText2315" font-family="微软雅黑" text-anchor="middle" font-size="17px" width="432px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="17px" weight="700" font-style="" opacity="1" y="9.073298613154748" transform="rotate(0)"><tspan id="SvgjsTspan2316" dy="21" x="226"><tspan id="SvgjsTspan2317" style="text-decoration:;">reviveOffers()</tspan></tspan><tspan id="SvgjsTspan2318" dy="21" x="226"><tspan id="SvgjsTspan2319" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2320" dy="21" x="226"><tspan id="SvgjsTspan2321" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2322" dy="21" x="226"><tspan id="SvgjsTspan2323" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2324" dy="21" x="226"><tspan id="SvgjsTspan2325" style="text-decoration:;"> </tspan></tspan></text></g></g><g id="SvgjsG2326" transform="translate(132.93516802835632,1580.2176106770826)"><path id="SvgjsPath2327" d="M 0 0L 454.215129031925 0L 454.215129031925 71.04947725962256L 0 71.04947725962256Z" stroke="none" fill="none"></path><g id="SvgjsG2328"><text id="SvgjsText2329" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="455px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="700" font-style="" opacity="1" y="7.7747386298112815" transform="rotate(0)"><tspan id="SvgjsTspan2330" dy="17" x="227.5"><tspan id="SvgjsTspan2331" style="text-decoration:;">每添加一个TaskSetManager，就会一次</tspan></tspan><tspan id="SvgjsTspan2332" dy="17" x="227.5"><tspan id="SvgjsTspan2333" style="text-decoration:;">scheduler.reviveOffers()</tspan></tspan><tspan id="SvgjsTspan2334" dy="17" x="227.5"><tspan id="SvgjsTspan2335" style="text-decoration:;">其目的是通知调度后端，获取可用的Executor信息（WorkOffers）</tspan></tspan></text></g></g><g id="SvgjsG2336" transform="translate(972.9002968483533,1377.7215439480015)"><path id="SvgjsPath2337" d="M 0 4Q 0 0 4 0L 503.7941306418811 0Q 507.7941306418811 0 507.7941306418811 4L 507.7941306418811 123.50924428304643Q 507.7941306418811 127.50924428304643 503.7941306418811 127.50924428304643L 4 127.50924428304643Q 0 127.50924428304643 0 123.50924428304643Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ff9800"></path><g id="SvgjsG2338"><text id="SvgjsText2339" font-family="微软雅黑" text-anchor="middle" font-size="17px" width="488px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="17px" weight="700" font-style="" opacity="1" y="8.129622141523214" transform="rotate(0)"><tspan id="SvgjsTspan2340" dy="21" x="254"><tspan id="SvgjsTspan2341" style="text-decoration:;">reviveOffers()</tspan></tspan><tspan id="SvgjsTspan2342" dy="21" x="254"><tspan id="SvgjsTspan2343" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2344" dy="21" x="254"><tspan id="SvgjsTspan2345" style="text-decoration:;">driverEndPoint.send(ReviveOffers)</tspan></tspan><tspan id="SvgjsTspan2346" dy="21" x="254"><tspan id="SvgjsTspan2347" style="text-decoration:;">给Driver端发送ReviveOffer消息</tspan></tspan><tspan id="SvgjsTspan2348" dy="21" x="254"><tspan id="SvgjsTspan2349" style="text-decoration:;">Driver端其实就是SchedulerBackend的本身</tspan></tspan></text></g></g><g id="SvgjsG2350"><path id="SvgjsPath2351" d="M584.4722137451172 1591.0832824707031L778.6862552967352 1591.0832824707031L778.6862552967352 1441.4761660895247L972.9002968483533 1441.4761660895247" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker2352)"></path></g><g id="SvgjsG2354"><path id="SvgjsPath2355" d="M760.1249855889208 1199.8240865071614L760.1249855889208 1262.934323070776L356.5330257770407 1262.934323070776L356.5330257770407 1326.0445596343907" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker2356)"></path></g><g id="SvgjsG2358" transform="translate(972.9002968483533,1540.1297022501567)"><path id="SvgjsPath2359" d="M 0 4Q 0 0 4 0L 503.7941306418811 0Q 507.7941306418811 0 507.7941306418811 4L 507.7941306418811 123.50924428304643Q 507.7941306418811 127.50924428304643 503.7941306418811 127.50924428304643L 4 127.50924428304643Q 0 127.50924428304643 0 123.50924428304643Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG2360"><text id="SvgjsText2361" font-family="微软雅黑" text-anchor="middle" font-size="17px" width="488px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="17px" weight="700" font-style="" opacity="1" y="19.129622141523214" transform="rotate(0)"><tspan id="SvgjsTspan2362" dy="21" x="254"><tspan id="SvgjsTspan2363" style="text-decoration:;">receive()</tspan></tspan><tspan id="SvgjsTspan2364" dy="21" x="254"><tspan id="SvgjsTspan2365" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2366" dy="21" x="254"><tspan id="SvgjsTspan2367" style="text-decoration:;">case ReviveOffers =&gt; makeOffers()</tspan></tspan><tspan id="SvgjsTspan2368" dy="21" x="254"><tspan id="SvgjsTspan2369" style="text-decoration:;">接收到ReviveOffers类型的消息，执行makeOffers()方法</tspan></tspan></text></g></g><g id="SvgjsG2370"><path id="SvgjsPath2371" d="M1226.7973621692938 1505.2307882310479L1226.7973621692938 1522.6802452406023L1226.7973621692938 1522.6802452406023L1226.7973621692938 1540.1297022501567" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker2372)"></path></g><g id="SvgjsG2374" transform="translate(975.4002968483533,1732.969766092671)"><path id="SvgjsPath2375" d="M 0 4Q 0 0 4 0L 498.7941306418811 0Q 502.7941306418811 0 502.7941306418811 4L 502.7941306418811 97.33580641709455Q 502.7941306418811 101.33580641709455 498.7941306418811 101.33580641709455L 4 101.33580641709455Q 0 101.33580641709455 0 97.33580641709455Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG2376"><text id="SvgjsText2377" font-family="微软雅黑" text-anchor="middle" font-size="17px" width="483px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="17px" weight="700" font-style="" opacity="1" y="-4.957096791452727" transform="rotate(0)"><tspan id="SvgjsTspan2378" dy="21" x="251.5"><tspan id="SvgjsTspan2379" style="text-decoration:;">makeOffers()方法</tspan></tspan><tspan id="SvgjsTspan2380" dy="21" x="251.5"><tspan id="SvgjsTspan2381" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2382" dy="21" x="251.5"><tspan id="SvgjsTspan2383" style="text-decoration:;">过滤出目前还存活的Executor；将存活的Executors封装成一个</tspan></tspan><tspan id="SvgjsTspan2384" dy="21" x="251.5"><tspan id="SvgjsTspan2385" style="text-decoration:;">个的WorkOffer对象，存放到workOffers变量中</tspan></tspan><tspan id="SvgjsTspan2386" dy="21" x="251.5"><tspan id="SvgjsTspan2387" style="text-decoration:;"> </tspan></tspan></text></g></g><g id="SvgjsG2388" transform="translate(96.77040610977639,1740.2753691206203)"><path id="SvgjsPath2389" d="M 0 4Q 0 0 4 0L 503.9444446563713 0Q 507.9444446563713 0 507.9444446563713 4L 507.9444446563713 177.4746613969578Q 507.9444446563713 181.4746613969578 503.9444446563713 181.4746613969578L 4 181.4746613969578Q 0 181.4746613969578 0 177.4746613969578Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#bbdefb"></path><g id="SvgjsG2390"><text id="SvgjsText2391" font-family="微软雅黑" text-anchor="middle" font-size="17px" width="488px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="17px" weight="700" font-style="" opacity="1" y="3.6123306984788996" transform="rotate(0)"><tspan id="SvgjsTspan2392" dy="21" x="254"><tspan id="SvgjsTspan2393" style="text-decoration:;">resourceOffers(workOffers) 取出相应的Task</tspan></tspan><tspan id="SvgjsTspan2394" dy="21" x="254"><tspan id="SvgjsTspan2395" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2396" dy="21" x="254"><tspan id="SvgjsTspan2397" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2398" dy="21" x="254"><tspan id="SvgjsTspan2399" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2400" dy="21" x="254"><tspan id="SvgjsTspan2401" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2402" dy="21" x="254"><tspan id="SvgjsTspan2403" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2404" dy="21" x="254"><tspan id="SvgjsTspan2405" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2406" dy="21" x="254"><tspan id="SvgjsTspan2407" style="text-decoration:;"> </tspan></tspan></text></g></g><g id="SvgjsG2408"><path id="SvgjsPath2409" d="M1226.7973621692938 1667.6389465332031L1226.7973621692938 1700.3043563129372L1226.7973621692938 1700.3043563129372L1226.7973621692938 1732.969766092671" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker2410)"></path></g><g id="SvgjsG2412"><path id="SvgjsPath2413" d="M975.4002968483533 1783.6376693012185L790.0575738072505 1783.6376693012185L790.0575738072505 1831.0126998190992L604.7148507661477 1831.0126998190992" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker2414)"></path></g><g id="SvgjsG2416" transform="translate(154.88506413392747,1806.2916755676254)"><path id="SvgjsPath2417" d="M 0 0L 391.7151286080691 0L 391.7151286080691 69.51610449253099L 0 69.51610449253099Z" stroke="none" fill="none"></path><g id="SvgjsG2418"><text id="SvgjsText2419" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="392px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="700" font-style="" opacity="1" y="-19.491947753734507" transform="rotate(0)"><tspan id="SvgjsTspan2420" dy="17" x="196"><tspan id="SvgjsTspan2421" style="text-decoration:;">TaskScheduler从资源调度池rootPool中按照FIFO或者Fair调</tspan></tspan><tspan id="SvgjsTspan2422" dy="17" x="196"><tspan id="SvgjsTspan2423" style="text-decoration:;">度算法调度出相应的TaskSet对象；</tspan></tspan><tspan id="SvgjsTspan2424" dy="17" x="196"><tspan id="SvgjsTspan2425" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2426" dy="17" x="196"><tspan id="SvgjsTspan2427" style="text-decoration:;">根据Task任务的本地化调度级别，将相应的TaskSet中的Task</tspan></tspan><tspan id="SvgjsTspan2428" dy="17" x="196"><tspan id="SvgjsTspan2429" style="text-decoration:;">和WorkOffer对象封装成TaskDescription对象，然后将</tspan></tspan><tspan id="SvgjsTspan2430" dy="17" x="196"><tspan id="SvgjsTspan2431" style="text-decoration:;">TaskDescription对象进行返回</tspan></tspan></text></g></g><g id="SvgjsG2432" transform="translate(965.428067844447,1875.8077800601563)"><path id="SvgjsPath2433" d="M 0 4Q 0 0 4 0L 518.7385886496936 0Q 522.7385886496936 0 522.7385886496936 4L 522.7385886496936 125.05333444179678Q 522.7385886496936 129.05333444179678 518.7385886496936 129.05333444179678L 4 129.05333444179678Q 0 129.05333444179678 0 125.05333444179678Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ff9800"></path><g id="SvgjsG2434"><text id="SvgjsText2435" font-family="微软雅黑" text-anchor="middle" font-size="17px" width="503px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="17px" weight="700" font-style="" opacity="1" y="8.90166722089839" transform="rotate(0)"><tspan id="SvgjsTspan2436" dy="21" x="261.5"><tspan id="SvgjsTspan2437" style="text-decoration:;">launchTask(tasks: TaskDescriptions)</tspan></tspan><tspan id="SvgjsTspan2438" dy="21" x="261.5"><tspan id="SvgjsTspan2439" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2440" dy="21" x="261.5"><tspan id="SvgjsTspan2441" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2442" dy="21" x="261.5"><tspan id="SvgjsTspan2443" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2444" dy="21" x="261.5"><tspan id="SvgjsTspan2445" style="text-decoration:;"> </tspan></tspan></text></g></g><g id="SvgjsG2446" transform="translate(1057.5555396609839,1921.7500305175781)"><path id="SvgjsPath2447" d="M 0 0L 391.7151286080691 0L 391.7151286080691 69.51610449253099L 0 69.51610449253099Z" stroke="none" fill="none"></path><g id="SvgjsG2448"><text id="SvgjsText2449" font-family="微软雅黑" text-anchor="start" font-size="14px" width="392px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="14px" weight="700" font-style="" opacity="1" y="7.008052246265493" transform="rotate(0)"><tspan id="SvgjsTspan2450" dy="17" x="0"><tspan id="SvgjsTspan2451" style="text-decoration:;">1. 将TaskDescription对象进行序列化</tspan></tspan><tspan id="SvgjsTspan2452" dy="17" x="0"><tspan id="SvgjsTspan2453" style="text-decoration:;">2.将序列化后的TaskDescription封装成LaunchTask消息对象</tspan></tspan><tspan id="SvgjsTspan2454" dy="17" x="0"><tspan id="SvgjsTspan2455" style="text-decoration:;">发送给远程ExecutorEndPoint进行执行</tspan></tspan></text></g></g><g id="SvgjsG2456" transform="translate(938.928067844447,2029.4327431841425)"><path id="SvgjsPath2457" d="M 0 4Q 0 0 4 0L 571.7385886496936 0Q 575.7385886496936 0 575.7385886496936 4L 575.7385886496936 85.89134840928227Q 575.7385886496936 89.89134840928227 571.7385886496936 89.89134840928227L 4 89.89134840928227Q 0 89.89134840928227 0 85.89134840928227Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG2458"><text id="SvgjsText2459" font-family="微软雅黑" text-anchor="middle" font-size="17px" width="556px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="17px" weight="700" font-style="" opacity="1" y="32.320674204641136" transform="rotate(0)"><tspan id="SvgjsTspan2460" dy="21" x="288"><tspan id="SvgjsTspan2461" style="text-decoration:;">executorEndPoint.send(new SerializableBuffer(serializedTask))</tspan></tspan></text></g></g><g id="SvgjsG2462"><path id="SvgjsPath2463" d="M350.742628437962 1921.7500305175781L350.742628437962 1940.3344472810547L965.428067844447 1940.3344472810547" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker2464)"></path></g><g id="SvgjsG2466"><path id="SvgjsPath2467" d="M1226.7973621692938 2004.8611145019531L1226.7973621692938 2017.1469288430478L1226.7973621692938 2017.1469288430478L1226.7973621692938 2029.4327431841425" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker2468)"></path></g><g id="SvgjsG2470" transform="translate(25.009246402314474,2271.254720204023)"><path id="SvgjsPath2471" d="M 0 0L 680.1244858471525 0L 680.1244858471525 216.10022296546458L 0 216.10022296546458Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG2472"><text id="SvgjsText2473" font-family="微软雅黑" text-anchor="middle" font-size="15px" width="661px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="15px" weight="400" font-style="" opacity="1" y="-231.3248885172677" transform="rotate(0)"><tspan id="SvgjsTspan2474" dy="18" x="340.5"><tspan id="SvgjsTspan2475" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2476" dy="18" x="340.5"><tspan id="SvgjsTspan2477" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2478" dy="18" x="340.5"><tspan id="SvgjsTspan2479" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2480" dy="18" x="340.5"><tspan id="SvgjsTspan2481" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2482" dy="18" x="340.5"><tspan id="SvgjsTspan2483" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2484" dy="18" x="340.5"><tspan id="SvgjsTspan2485" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2486" dy="18" x="340.5"><tspan id="SvgjsTspan2487" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2488" dy="18" x="340.5"><tspan id="SvgjsTspan2489" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2490" dy="18" x="340.5"><tspan id="SvgjsTspan2491" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2492" dy="18" x="340.5"><tspan id="SvgjsTspan2493" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2494" dy="18" x="340.5"><tspan id="SvgjsTspan2495" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2496" dy="18" x="340.5"><tspan id="SvgjsTspan2497" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2498" dy="18" x="340.5"><tspan id="SvgjsTspan2499" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2500" dy="18" x="340.5"><tspan id="SvgjsTspan2501" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2502" dy="18" x="340.5"><tspan id="SvgjsTspan2503" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2504" dy="18" x="340.5"><tspan id="SvgjsTspan2505" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2506" dy="18" x="340.5"><tspan id="SvgjsTspan2507" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2508" dy="18" x="340.5"><tspan id="SvgjsTspan2509" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2510" dy="18" x="340.5"><tspan id="SvgjsTspan2511" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2512" dy="18" x="340.5"><tspan id="SvgjsTspan2513" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2514" dy="18" x="340.5"><tspan id="SvgjsTspan2515" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2516" dy="18" x="340.5"><tspan id="SvgjsTspan2517" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2518" dy="18" x="340.5"><tspan id="SvgjsTspan2519" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2520" dy="18" x="340.5"><tspan id="SvgjsTspan2521" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2522" dy="18" x="340.5"><tspan id="SvgjsTspan2523" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2524" dy="18" x="340.5"><tspan id="SvgjsTspan2525" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2526" dy="18" x="340.5"><tspan id="SvgjsTspan2527" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2528" dy="18" x="340.5"><tspan id="SvgjsTspan2529" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2530" dy="18" x="340.5"><tspan id="SvgjsTspan2531" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2532" dy="18" x="340.5"><tspan id="SvgjsTspan2533" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2534" dy="18" x="340.5"><tspan id="SvgjsTspan2535" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2536" dy="18" x="340.5"><tspan id="SvgjsTspan2537" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2538" dy="18" x="340.5"><tspan id="SvgjsTspan2539" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2540" dy="18" x="340.5"><tspan id="SvgjsTspan2541" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2542" dy="18" x="340.5"><tspan id="SvgjsTspan2543" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2544" dy="18" x="340.5"><tspan id="SvgjsTspan2545" style="text-decoration:;"> </tspan></tspan></text></g></g><g id="SvgjsG2546" transform="translate(310.3956027453268,2277.1607095888658)"><path id="SvgjsPath2547" d="M 0 0L 330.4769125105496 0L 330.4769125105496 23.768253504225157L 0 23.768253504225157Z" stroke="none" fill="none"></path><g id="SvgjsG2548"><text id="SvgjsText2549" font-family="微软雅黑" text-anchor="start" font-size="15px" width="331px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="15px" weight="700" font-style="" opacity="1" y="0.5091267521125786" transform="rotate(0)"><tspan id="SvgjsTspan2550" dy="18" x="0"><tspan id="SvgjsTspan2551" style="text-decoration:;">CoarseGrainedExecutorBackend</tspan></tspan></text></g></g><g id="SvgjsG2552" transform="translate(55.42571087588286,2343.6713478760125)"><path id="SvgjsPath2553" d="M 0 4Q 0 0 4 0L 165.86557518076432 0Q 169.86557518076432 0 169.86557518076432 4L 169.86557518076432 88.61104075113872Q 169.86557518076432 92.61104075113872 165.86557518076432 92.61104075113872L 4 92.61104075113872Q 0 92.61104075113872 0 88.61104075113872Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#81c784"></path><g id="SvgjsG2554"><text id="SvgjsText2555" font-family="微软雅黑" text-anchor="middle" font-size="17px" width="150px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="17px" weight="700" font-style="" opacity="1" y="33.68052037556936" transform="rotate(0)"><tspan id="SvgjsTspan2556" dy="21" x="85"><tspan id="SvgjsTspan2557" style="text-decoration:;">Executor</tspan></tspan></text></g></g><g id="SvgjsG2558" transform="translate(494.79417903199055,2343.6713478760125)"><path id="SvgjsPath2559" d="M 0 4Q 0 0 4 0L 165.86557518076432 0Q 169.86557518076432 0 169.86557518076432 4L 169.86557518076432 88.61104075113872Q 169.86557518076432 92.61104075113872 165.86557518076432 92.61104075113872L 4 92.61104075113872Q 0 92.61104075113872 0 88.61104075113872Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#81c784"></path><g id="SvgjsG2560"><text id="SvgjsText2561" font-family="微软雅黑" text-anchor="middle" font-size="17px" width="150px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="17px" weight="700" font-style="" opacity="1" y="33.68052037556936" transform="rotate(0)"><tspan id="SvgjsTspan2562" dy="21" x="85"><tspan id="SvgjsTspan2563" style="text-decoration:;">Executor</tspan></tspan></text></g></g><g id="SvgjsG2564" transform="translate(280.1387017355086,2343.6713478760125)"><path id="SvgjsPath2565" d="M 0 4Q 0 0 4 0L 165.86557518076432 0Q 169.86557518076432 0 169.86557518076432 4L 169.86557518076432 88.61104075113872Q 169.86557518076432 92.61104075113872 165.86557518076432 92.61104075113872L 4 92.61104075113872Q 0 92.61104075113872 0 88.61104075113872Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#81c784"></path><g id="SvgjsG2566"><text id="SvgjsText2567" font-family="微软雅黑" text-anchor="middle" font-size="17px" width="150px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="17px" weight="700" font-style="" opacity="1" y="33.68052037556936" transform="rotate(0)"><tspan id="SvgjsTspan2568" dy="21" x="85"><tspan id="SvgjsTspan2569" style="text-decoration:;">Executor</tspan></tspan></text></g></g><g id="SvgjsG2570"><path id="SvgjsPath2571" d="M1226.7973621692938 2119.324091593425L1226.7973621692938 2195.289405898724L365.07148932589075 2195.289405898724L365.07148932589075 2271.254720204023" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker2572)"></path></g><g id="SvgjsG2574" transform="translate(815.4217085404831,2274.7088218414087)"><path id="SvgjsPath2575" d="M 0 4Q 0 0 4 0L 732.3813115900214 0Q 736.3813115900214 0 736.3813115900214 4L 736.3813115900214 226.5360928203454Q 736.3813115900214 230.5360928203454 732.3813115900214 230.5360928203454L 4 230.5360928203454Q 0 230.5360928203454 0 226.5360928203454Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG2576"><text id="SvgjsText2577" font-family="微软雅黑" text-anchor="middle" font-size="17px" width="717px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="17px" weight="700" font-style="" opacity="1" y="7.143046410172701" transform="rotate(0)"><tspan id="SvgjsTspan2578" dy="21" x="368.5"><tspan id="SvgjsTspan2579" style="text-decoration:;">CoarseGrainedExecutorBackend</tspan></tspan><tspan id="SvgjsTspan2580" dy="21" x="368.5"><tspan id="SvgjsTspan2581" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2582" dy="21" x="368.5"><tspan id="SvgjsTspan2583" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2584" dy="21" x="368.5"><tspan id="SvgjsTspan2585" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2586" dy="21" x="368.5"><tspan id="SvgjsTspan2587" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2588" dy="21" x="368.5"><tspan id="SvgjsTspan2589" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2590" dy="21" x="368.5"><tspan id="SvgjsTspan2591" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2592" dy="21" x="368.5"><tspan id="SvgjsTspan2593" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2594" dy="21" x="368.5"><tspan id="SvgjsTspan2595" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2596" dy="21" x="368.5"><tspan id="SvgjsTspan2597" style="text-decoration:;"> </tspan></tspan></text></g></g><g id="SvgjsG2598"><path id="SvgjsPath2599" d="M704.512617631392 2394.234838312322C 748.9089359568013 2394.234838312322 771.0253902150738 2389.9768682515814 815.4217085404831 2389.9768682515814" stroke-dasharray="3,3" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker2600)"></path><rect id="SvgjsRect2602" width="36" height="23" x="741.9671630859375" y="2380.605853281952" fill="#ffffff"></rect><text id="SvgjsText2603" font-family="微软雅黑" text-anchor="middle" font-size="18px" width="36px" fill="#323232" font-weight="700" align="top" lineHeight="23px" anchor="middle" family="微软雅黑" size="18px" weight="700" font-style="" opacity="1" y="2378.355853281952" transform="rotate(0)"><tspan id="SvgjsTspan2604" dy="22" x="759.9671630859375"><tspan id="SvgjsTspan2605" style="text-decoration:;">说明</tspan></tspan></text></g><g id="SvgjsG2606" transform="translate(933.5530158919527,2319.858682108296)"><path id="SvgjsPath2607" d="M 0 0L 538.6490007650971 0L 538.6490007650971 162.68800061158436L 0 162.68800061158436Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#fff9c4"></path><g id="SvgjsG2608"><text id="SvgjsText2609" font-family="微软雅黑" text-anchor="middle" font-size="15px" width="519px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="15px" weight="400" font-style="" opacity="1" y="4.4690003057921786" transform="rotate(0)"><tspan id="SvgjsTspan2610" dy="18" x="269.5"><tspan id="SvgjsTspan2611" style="text-decoration:;">receive()方法接收SchedulerBackend发送的任务</tspan></tspan><tspan id="SvgjsTspan2612" dy="18" x="269.5"><tspan id="SvgjsTspan2613" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2614" dy="18" x="269.5"><tspan id="SvgjsTspan2615" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2616" dy="18" x="269.5"><tspan id="SvgjsTspan2617" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2618" dy="18" x="269.5"><tspan id="SvgjsTspan2619" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2620" dy="18" x="269.5"><tspan id="SvgjsTspan2621" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2622" dy="18" x="269.5"><tspan id="SvgjsTspan2623" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2624" dy="18" x="269.5"><tspan id="SvgjsTspan2625" style="text-decoration:;"> </tspan></tspan></text></g></g><g id="SvgjsG2626" transform="translate(1016.6464487518922,2357.8636206982765)"><path id="SvgjsPath2627" d="M 0 0L 413.3207143340446 0L 413.3207143340446 116.37121761404569L 0 116.37121761404569Z" stroke="none" fill="none"></path><g id="SvgjsG2628"><text id="SvgjsText2629" font-family="微软雅黑" text-anchor="start" font-size="14px" width="414px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="14px" weight="700" font-style="" opacity="1" y="3.935608807022845" transform="rotate(0)"><tspan id="SvgjsTspan2630" dy="17" x="0"><tspan id="SvgjsTspan2631" style="text-decoration:;">1. 每次进入到receive方法内部，都会创建一个executor对象</tspan></tspan><tspan id="SvgjsTspan2632" dy="17" x="0"><tspan id="SvgjsTspan2633" style="text-decoration:;">                    executor=new Executor(........)</tspan></tspan><tspan id="SvgjsTspan2634" dy="17" x="0"><tspan id="SvgjsTspan2635" style="text-decoration:;">2. 然后将接收到的LaunchTask消息进行反序列化，反序列化成</tspan></tspan><tspan id="SvgjsTspan2636" dy="17" x="0"><tspan id="SvgjsTspan2637" style="text-decoration:;">TaskDescription对象；</tspan></tspan><tspan id="SvgjsTspan2638" dy="17" x="0"><tspan id="SvgjsTspan2639" style="text-decoration:;">3. 通过executor.launchTask(.....) 在相应的Executor对象中执行</tspan></tspan><tspan id="SvgjsTspan2640" dy="17" x="0"><tspan id="SvgjsTspan2641" style="text-decoration:;">具体的任务Task</tspan></tspan></text></g></g><g id="SvgjsG2642" transform="translate(472.14954423433517,2599.2699292467223)"><path id="SvgjsPath2643" d="M 0 4Q 0 0 4 0L 623.3675481042733 0Q 627.3675481042733 0 627.3675481042733 4L 627.3675481042733 178.94475636673678Q 627.3675481042733 182.94475636673678 623.3675481042733 182.94475636673678L 4 182.94475636673678Q 0 182.94475636673678 0 178.94475636673678Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#81c784"></path><g id="SvgjsG2644"><text id="SvgjsText2645" font-family="微软雅黑" text-anchor="middle" font-size="17px" width="608px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="17px" weight="700" font-style="" opacity="1" y="15.347378183368392" transform="rotate(0)"><tspan id="SvgjsTspan2646" dy="21" x="314"><tspan id="SvgjsTspan2647" style="text-decoration:;">Executor</tspan></tspan><tspan id="SvgjsTspan2648" dy="21" x="314"><tspan id="SvgjsTspan2649" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2650" dy="21" x="314"><tspan id="SvgjsTspan2651" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2652" dy="21" x="314"><tspan id="SvgjsTspan2653" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2654" dy="21" x="314"><tspan id="SvgjsTspan2655" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2656" dy="21" x="314"><tspan id="SvgjsTspan2657" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan2658" dy="21" x="314"><tspan id="SvgjsTspan2659" style="text-decoration:;"> </tspan></tspan></text></g></g><g id="SvgjsG2660" transform="translate(516.6307055636005,2665.0775231986436)"><path id="SvgjsPath2661" d="M 0 0L 563.7954776840985 0L 563.7954776840985 121.96106631565317L 0 121.96106631565317Z" stroke="none" fill="none"></path><g id="SvgjsG2662"><text id="SvgjsText2663" font-family="微软雅黑" text-anchor="start" font-size="14px" width="564px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="14px" weight="700" font-style="" opacity="1" y="24.230533157826585" transform="rotate(0)"><tspan id="SvgjsTspan2664" dy="17" x="0"><tspan id="SvgjsTspan2665" style="text-decoration:;">1. 根据传递传递过来的具体的任务，创建实现了Runnable接口的TaskRunner对象rn</tspan></tspan><tspan id="SvgjsTspan2666" dy="17" x="0"><tspan id="SvgjsTspan2667" style="text-decoration:;">2. 记录正在运行的Task到ConCurrentHashMap中runningTasks</tspan></tspan><tspan id="SvgjsTspan2668" dy="17" x="0"><tspan id="SvgjsTspan2669" style="text-decoration:;">3. 通过线程池的方式运行（execute(tr)）运行上述的TaskRunner对象（TaskRunner对</tspan></tspan><tspan id="SvgjsTspan2670" dy="17" x="0"><tspan id="SvgjsTspan2671" style="text-decoration:;">象的run方法中就是具体Task执行的地方）</tspan></tspan></text></g></g><g id="SvgjsG2672"><path id="SvgjsPath2673" d="M1202.8775162745012 2482.54668271988L1202.8775162745012 2540.908305983301L785.8333182864718 2540.908305983301L785.8333182864718 2599.2699292467223" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker2674)"></path></g><g id="SvgjsG2676"><path id="SvgjsPath2677" d="M753.5833182864718 60.00922648111897L753.5833182864718 117.78701591491648L753.5833182864718 117.78701591491648L753.5833182864718 175.56480534871397" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker2678)"></path></g></svg>